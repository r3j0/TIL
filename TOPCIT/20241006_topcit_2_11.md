### 트랜잭션
- 하나의 논리적 작업 단위를 이루는 여러 연산들의 집합
- 한 번에 수행되어야 할 데이터베이스의 일련의 읽기(Read)와 쓰기(Write) 연산을 수행하는ㄷ ㅏㄴ위

### 트랜잭션 특징
1. Atomicity (원자성) : 1개 트랜잭션에서 모든 데이터는 동시에 성공하던지 실패하던지
2. Consistency (일관성) : 항상 기대되는 값을 정확하게 보여줘야 하고, 중간에 다른 트랜잭션이 끼어들지 못하도록
3. Isolation (고립성) : 트랜잭션의 Commit 또는 Rollback 하기 전에 다른 트랜잭션이 끼어들면 안됨
4. Durability (영속성) : 한번 성공한 트랜잭션은 지속성을 보장해야 함.

### 트랜잭션 종료 시
- 트랜잭션 완료 (Commit) 연산 : 모든 SQL 문장 결과를 데이터베이스에 영구적 반영. 트랜잭션 종료
- 트랜잭션 복귀 (Rollback) 연산 : 지금까지 수행한 트랜잭션 안에서 변경된 모든 데이터 값을 이전 상태로 되돌림

### 트랜잭션 처리 시 고려사항
- 트랜잭션의 동시성 구현
- 수행시간을 최대한 짧게 수행

### 직렬가능 스케줄
- 각각의 트랜잭션이 동시에 수행되더라도, 그 결과가 순차적으로 트랜잭션이 수행한 결과와 같음

### 동시성(병행) 제어
- 다중 사용자 환경을 지원하는 데이터베이스 시스템에서 여러 트랜잭션들이 성공적으로 동시에 실행되도록 지원
- 목적 : 직렬가능성 보장, 공유도 최대, 응답시간 최소, 활동성 최대, 무결성 및 일관성 보장
- 하지 않을 경우 문제점 : 갱신 손실 (동일 데이터 동시 갱신), 오손 데이터읽기 (중간 수행결과를 다른 트랜잭션이 참조), 모순성, 연쇄복귀, 반복할 수 없는 읽기 (중간에 다른 트랜잭션이 수행해 질의 결과가 다르게)

### 동시성 제어 기법들
- 잠금 기반 기법, 타임스탬프 기반 기법, 다중버전 기법, 검증(낙관적) 기반 기법

### 2PL (2-Phase Locking) 기법
- 직렬성 보장을 통해 동시성 제어하는 2단계 잠금 기법(Locking). 확장 -> 연산 차단단계 -> 수축
- 확장단계 : 트랜잭션은 Lock만 수행하고 Unlock은 수행할 수 없는 단계
- 수축단계 : Unlock만 수행하고 Lock은 수행할 수 없는 단계

### 트랜잭션 격리수준 (Isolation Level)
1. 완료되지 않은 읽기 (Read Uncommitted) : 아직 처리 완료되지 않은 데이터를 다른 트랜잭션이 읽도록 허용
2. 완료된 읽기 (Read Committed) : 확정된 데이터만 다른 트랜잭션이 읽도록 허용
3. 반복 읽기 (Repeatable Read) : 첫 번째 질의에 있던 레코드가 사라지거나 같이 바뀌는 현상 방지
4. 직렬화 (Serializable Read) : 반복 읽기에 이어 새 레코드가 나타나지도 않게 함

![.](https://velog.velcdn.com/images/yujiniii/post/d4a63a9f-b11c-41ed-9eba-df56281dcd27/image.png)

### 교착상태 (Deadlock)
- 다중처리 환경에서 다수 프로세스 또는 트랜잭션이 특정자원 할당을 무한정 기다리고 있는 상태.
- Starvation (무한 대기) 는 자원을 할당 받기 위한 무한정 대기 상태.

### 교착상태 발생원인 (동시 성립 시 발생)
- 상호배제 (Mutual Exclusion) : 자원을 배타적으로 점유, 다른 프로세스가 그 자원 사용 못함
- 점유와 대기 (Block & Wait) : 어떤 자원을 할당 받아 점유하고 있으면서 다른 자원 요구
- 비선점 (Non Preemption) : 할당된 자원은 끝날 때 까지 빼앗을 수 없음
- 환형 대기 (Circular wait) : 자원 요구가 하나의 원형을 구성 

[https://lealea.tistory.com/244](https://lealea.tistory.com/244)

### 교착상태 해결방안
- 교창상태 예방 (규약, 회피기법)
- 교창상태 탐지와 복구 (Detection : 상태 감시 알고리즘, Recovery : deadlock 없어질 때 까지 프로세스 순차적으로 kill)
